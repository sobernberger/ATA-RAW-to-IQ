# ATA-RAW-to-IQ

This is a Python script which converts the ATA's beamformer output to an IQ timeseries.
The RAW files are read using Wael Farahs [guppi package](https://github.com/wfarah/guppi), which also provides information from header files, such as: 
1. Channel Bandwidth 
2. Total Bandwidth
3. Center Frequency (Header['OBSFREQ] denotes the freqency at which the middle channel starts. Therefore the center frequency can be calculated by adding half of the channels bandwidth)
4. Number of Samples per Spectrum
5. Time per Spectrum
6. Header Size

An example for a header is provided in Header_Example.md.


The IQ timesamples are generated by reading in a spectrum, and converting it to an IQ spectrum and then performing a FFT. The resulting timesamples are then interleaved ad saved to disc along with [sigmf](https://github.com/gnuradio/SigMF) metadata, which consists of a header of the original *.raw file as well as some additional information, such as the number of blocks which were processed, the total time these blocks amount to, the polarisation of the processed data, the saved data type, the resulting bandwidth and the frequency the data is centered around. This is repeated for the amount of blocks specified by the user.

The script uses command line inputs to hand user specific options to the script:

1. -i (required) Path to the input *.raw file
2. -o (required) Desired path and name of the output file (don't add a file type extention)
3. -decim Decimation factor used in a FIR Filter. A higher decimation factor reduces bandwidth, therefore data size and aliasing. Default = 1.
4. -fc Freqency which will be centered around DC after processing. Note that this expects a passband freqency. This means, that the input spectrum beginns at DC and ends at Header['OBSBW'] (in MHz) the center frequency has to be choosen from that interval. The center freqency is also limited by Header['CHAN_BW'], as it can only be a multiple of the bandwidth. Default = Header['OBSBW']/2
5. -X or -Y Pick the polarisation that should be converted. Default is X therefore this has only to be specified for Y polarisation.





# Example

![Passband Spectrum](RF.png)

![Baseband Spectrum](IQ-decim_conv.png)